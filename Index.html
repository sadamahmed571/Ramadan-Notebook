<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…ÙÙƒØ±Ø© Ø±Ù…Ø¶Ø§Ù† | Ramadan Planner</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                    },
                    colors: {
                        navy: '#1e3a8a',
                        gold: '#fbbf24',
                        offwhite: '#f8fafc',
                        serenity: '#60a5fa', // Blue for serenity mode
                    }
                }
            }
        }
    </script>

    <style>
        body { -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Compact Card Style */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .dark .glass-card {
            background: rgba(30, 58, 138, 0.9);
            border: 1px solid rgba(251, 191, 36, 0.2);
        }

        /* Animations */
        @keyframes pulse-gold {
            0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
            100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); }
        }
        .animate-pulse-gold {
            animation: pulse-gold 1.5s infinite;
        }
    </style>
</head>
<body class="bg-offwhite text-slate-800 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // --- Components ---

        // 1. Progress Widget (Circular)
        const ProgressWidget = ({ progress, nextPrayer }) => {
            const radius = 50;
            const stroke = 8;
            const normalizedRadius = radius - stroke * 2;
            const circumference = normalizedRadius * 2 * Math.PI;
            const strokeDashoffset = circumference - (progress / 100) * circumference;

            return (
                <div class="flex items-center justify-between p-4 glass-card rounded-2xl mb-3">
                    <div class="relative w-24 h-24 flex items-center justify-center">
                        <svg height={radius * 2} width={radius * 2} class="rotate-[-90deg]">
                            <circle
                                stroke="#e2e8f0"
                                strokeWidth={stroke}
                                r={normalizedRadius}
                                cx={radius}
                                cy={radius}
                                fill="transparent"
                            />
                            <circle
                                stroke="#fbbf24"
                                strokeWidth={stroke}
                                strokeDasharray={circumference + ' ' + circumference}
                                style={{ strokeDashoffset, transition: 'stroke-dashoffset 0.5s ease-in-out' }}
                                strokeLinecap="round"
                                r={normalizedRadius}
                                cx={radius}
                                cy={radius}
                                fill="transparent"
                            />
                        </svg>
                        <div class="absolute text-center">
                            <span class="text-xl font-bold text-navy dark:text-white block">{Math.round(progress)}%</span>
                            <span class="text-[10px] text-gray-500 dark:text-gray-300">Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ÙŠÙˆÙ…</span>
                        </div>
                    </div>

                    <div class="flex-1 mr-4 text-right">
                        <div class="text-xs text-gray-500 dark:text-gray-300 mb-1">Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</div>
                        <h2 class="text-2xl font-bold text-navy dark:text-gold">{nextPrayer.name}</h2>
                        <div class="flex items-center gap-1 mt-1 text-gold font-medium">
                            <i data-lucide="clock" class="w-4 h-4"></i>
                            <span>{nextPrayer.time}</span>
                        </div>
                    </div>
                </div>
            );
        };

        // 2. Compact Tracker Strip
        const TrackerStrip = ({ items, onItemToggle }) => {
            return (
                <div class="glass-card rounded-xl p-3 mb-3 overflow-x-auto no-scrollbar">
                    <div class="flex justify-between gap-3 min-w-max px-1">
                        {items.map((item) => (
                            <button
                                key={item.id}
                                onClick={() => onItemToggle(item.id)}
                                class={`flex flex-col items-center justify-center w-14 h-16 rounded-xl transition-all duration-200 active:scale-95 ${
                                    item.completed 
                                    ? 'bg-navy text-gold shadow-lg' 
                                    : 'bg-gray-100 text-gray-400'
                                }`}
                            >
                                <div class="mb-1">{item.icon}</div>
                                <span class="text-[10px] font-medium">{item.label}</span>
                                {item.completed && <div class="w-1 h-1 bg-gold rounded-full mt-1"></div>}
                            </button>
                        ))}
                    </div>
                </div>
            );
        };

        // 3. Floating Action Button (Tasbih)
        const TasbihFAB = ({ count, onIncrement }) => {
            return (
                <button 
                    onClick={onIncrement}
                    class="fixed bottom-6 left-6 w-16 h-16 bg-navy rounded-full shadow-2xl flex items-center justify-center z-50 active:scale-90 transition-transform border-4 border-gold/30 animate-pulse-gold"
                >
                    <div class="text-center text-white">
                        <span class="block text-xs opacity-80">Ø³Ø¨Ù‘Ø­</span>
                        <span class="block text-lg font-bold text-gold">{count}</span>
                    </div>
                </button>
            );
        };

        // 4. Modal Component
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div class="fixed inset-0 z-50 flex items-end justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200">
                    <div class="bg-white dark:bg-slate-900 w-full rounded-2xl p-5 shadow-2xl animate-in slide-in-from-bottom duration-300">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold text-navy dark:text-white">{title}</h3>
                            <button onClick={onClose} class="p-1 bg-gray-100 rounded-full"><i data-lucide="x" class="w-5 h-5 text-gray-600"></i></button>
                        </div>
                        {children}
                    </div>
                </div>
            );
        };

        // --- Main App ---
        function App() {
            // Local Storage Logic (Simulating No Backend)
            const [mounted, setMounted] = useState(false);
            const [serenityMode, setSerenityMode] = useState(false);
            const [tasbihCount, setTasbihCount] = useState(() => parseInt(localStorage.getItem('tasbih')) || 0);
            const [dedication, setDedication] = useState(() => localStorage.getItem('dedication') || '');
            const [showDedicationModal, setShowDedicationModal] = useState(!localStorage.getItem('dedication'));
            
            // Dummy Data for Logic
            const [trackerItems, setTrackerItems] = useState([
                { id: 'fajr', label: 'Ø§Ù„ÙØ¬Ø±', completed: false, icon: <i data-lucide="sunrise" class="w-5 h-5"/> },
                { id: 'dhuhr', label: 'Ø§Ù„Ø¸Ù‡Ø±', completed: false, icon: <i data-lucide="sun" class="w-5 h-5"/> },
                { id: 'asr', label: 'Ø§Ù„Ø¹ØµØ±', completed: false, icon: <i data-lucide="cloud-sun" class="w-5 h-5"/> },
                { id: 'maghrib', label: 'Ø§Ù„Ù…ØºØ±Ø¨', completed: false, icon: <i data-lucide="sunset" class="w-5 h-5"/> },
                { id: 'isha', label: 'Ø§Ù„Ø¹Ø´Ø§Ø¡', completed: false, icon: <i data-lucide="moon" class="w-5 h-5"/> },
                { id: 'taraweeh', label: 'ØªØ±Ø§ÙˆÙŠØ­', completed: false, icon: <i data-lucide="star" class="w-5 h-5"/> },
                { id: 'quran', label: 'ÙˆØ±Ø¯', completed: false, icon: <i data-lucide="book-open" class="w-5 h-5"/> },
            ]);

            // Effects
            useEffect(() => {
                lucide.createIcons();
                setMounted(true);
            }, [trackerItems]);

            useEffect(() => {
                localStorage.setItem('tasbih', tasbihCount);
            }, [tasbihCount]);

            useEffect(() => {
                if(dedication) localStorage.setItem('dedication', dedication);
            }, [dedication]);

            // Handlers
            const handleTrack = (id) => {
                if (navigator.vibrate) navigator.vibrate(20); // Haptic
                setTrackerItems(prev => prev.map(item => 
                    item.id === id ? { ...item, completed: !item.completed } : item
                ));
            };

            const handleTasbih = () => {
                if (navigator.vibrate) navigator.vibrate(10); // Light Haptic
                setTasbihCount(p => p + 1);
            };

            const saveDedication = (name) => {
                setDedication(name);
                setShowDedicationModal(false);
            };

            // Calculated
            const progress = useMemo(() => {
                const completed = trackerItems.filter(i => i.completed).length;
                return (completed / trackerItems.length) * 100;
            }, [trackerItems]);

            if (!mounted) return null;

            return (
                <div class={`min-h-screen px-4 py-6 font-sans flex flex-col ${serenityMode ? 'bg-blue-50' : 'bg-offwhite'} transition-colors`}>
                    
                    {/* Header */}
                    <div class="flex justify-between items-center mb-6">
                        <div class="flex flex-col">
                            <span class="text-xs text-gray-500 font-bold">1 Ø±Ù…Ø¶Ø§Ù† | 1447</span>
                            <h1 class="text-xl font-bold text-navy">Ù…ÙÙƒØ±Ø© Ø±Ù…Ø¶Ø§Ù†</h1>
                        </div>
                        <div class="flex gap-2">
                             <button 
                                onClick={() => setSerenityMode(!serenityMode)}
                                class={`p-2 rounded-full ${serenityMode ? 'bg-serenity text-white' : 'bg-gray-200 text-gray-600'}`}
                             >
                                <i data-lucide="coffee" class="w-5 h-5"></i>
                            </button>
                             <button 
                                onClick={() => alert('Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø®ØµÙˆØµÙŠØ©: Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø© Ù…Ø­Ù„ÙŠØ§Ù‹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ ğŸ”’')}
                                class="p-2 bg-white rounded-full text-navy shadow-sm"
                             >
                                <i data-lucide="shield-check" class="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>

                    {/* Dashboard */}
                    <ProgressWidget 
                        progress={progress} 
                        nextPrayer={{ name: 'Ø§Ù„Ù…ØºØ±Ø¨', time: '02:45:10' }} 
                    />

                    {/* Daily Challenge */}
                    <div class="bg-navy rounded-lg p-3 flex items-center gap-3 text-white mb-4 shadow-lg">
                        <div class="bg-gold p-1 rounded text-navy"><i data-lucide="zap" class="w-4 h-4"></i></div>
                        <p class="text-sm font-medium">ØªØ­Ø¯ÙŠ Ø§Ù„ÙŠÙˆÙ…: Ø¥ÙØ·Ø§Ø± ØµØ§Ø¦Ù… ÙˆÙ„Ùˆ Ø¨Ø´Ù‚ ØªÙ…Ø±Ø©</p>
                    </div>

                    {/* Tracker */}
                    <div class="mb-2">
                        <div class="flex justify-between items-end mb-2 px-1">
                            <h3 class="font-bold text-navy text-sm">Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h3>
                            <span class="text-[10px] text-gray-400">Ø§Ù†Ù‚Ø± Ù„Ù„ØªÙØ¹ÙŠÙ„</span>
                        </div>
                        <TrackerStrip items={trackerItems} onItemToggle={handleTrack} />
                    </div>

                    {/* Quran Compact Input */}
                    <div class="glass-card p-4 rounded-xl flex justify-between items-center mb-4">
                        <div>
                            <h3 class="font-bold text-navy text-sm">Ø®ØªÙ…Ø© Ø§Ù„Ù‚Ø±Ø¢Ù†</h3>
                            <p class="text-xs text-gray-500 mt-1">Ø¢Ø®Ø± ÙˆØµÙˆÙ„: ØµÙØ­Ø© 45</p>
                        </div>
                         <button class="bg-navy text-white px-4 py-2 rounded-lg text-xs font-bold">+ ØªØ³Ø¬ÙŠÙ„</button>
                    </div>

                    {/* Dedication Area */}
                    <div class="mt-auto pt-6 text-center opacity-80">
                        <p class="text-xs text-gray-400">Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ù„ ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ø¹Ù†</p>
                        <p class="text-sm font-bold text-navy mt-1 cursor-pointer" onClick={() => setShowDedicationModal(true)}>
                            {dedication || "Ø§Ø¶ØºØ· Ù„ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø§Ø³Ù…"} â¤ï¸
                        </p>
                    </div>

                    {/* Footer Signature */}
                    <div class="mt-8 mb-20 text-center border-t border-gray-200 pt-4">
                        <p class="text-[10px] text-gray-400">ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ±: ØµØ¯Ø§Ù… Ø£Ø­Ù…Ø¯</p>
                        <div class="flex justify-center gap-4 mt-2 opacity-50">
                             <i data-lucide="twitter" class="w-3 h-3"></i>
                             <i data-lucide="github" class="w-3 h-3"></i>
                        </div>
                    </div>

                    {/* FAB */}
                    <TasbihFAB count={tasbihCount} onIncrement={handleTasbih} />

                    {/* Dedication Modal */}
                    <Modal 
                        isOpen={showDedicationModal} 
                        onClose={() => setShowDedicationModal(false)}
                        title="Ù„Ù…Ù† ØªÙ‡Ø¯ÙŠ Ø«ÙˆØ§Ø¨ Ù‡Ø°Ø§ Ø§Ù„Ø¹Ù…Ù„ØŸ"
                    >
                        <form onSubmit={(e) => { e.preventDefault(); saveDedication(e.target.name.value); }}>
                            <input 
                                name="name"
                                type="text" 
                                placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø§Ø³Ù… Ù‡Ù†Ø§ (Ù…Ø«Ù„Ø§Ù‹: ÙˆØ§Ù„Ø¯ÙŠ Ø±Ø­Ù…Ù‡ Ø§Ù„Ù„Ù‡)" 
                                class="w-full p-3 bg-gray-50 rounded-lg text-right text-sm border-2 border-transparent focus:border-navy outline-none mb-4"
                                autoFocus
                            />
                            <button type="submit" class="w-full bg-gold text-navy font-bold py-3 rounded-xl shadow-lg">
                                ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥Ù‡Ø¯Ø§Ø¡
                            </button>
                        </form>
                    </Modal>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
