<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مفكرة رمضان | Ramadan Planner</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/dexie/dist/dexie.js"></script>

    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Tajawal', 'sans-serif'],
                    },
                    colors: {
                        navy: '#1e3a8a',
                        gold: '#fbbf24',
                        emerald: '#10b981',
                        offwhite: '#f8fafc',
                        serenity: '#60a5fa',
                        royalblue: '#2563eb',
                        oled: '#000000',
                    }
                }
            }
        }
    </script>

    <style>
        body { -webkit-tap-highlight-color: transparent; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        /* Compact Card Style */
        .glass-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(226, 232, 240, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        }
        .dark .glass-card {
            background: rgba(15, 23, 42, 0.9);
            border: 1px solid rgba(251, 191, 36, 0.2);
        }
        .dark.oled-mode .glass-card {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(251, 191, 36, 0.1);
        }
        .dark.oled-mode body {
            background-color: #000000;
        }

        /* Animations */
        @keyframes pulse-gold {
            0% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(251, 191, 36, 0); }
            100% { box-shadow: 0 0 0 0 rgba(251, 191, 36, 0); }
        }
        .animate-pulse-gold {
            animation: pulse-gold 1.5s infinite;
        }
    </style>
</head>
<body class="bg-offwhite text-slate-800 transition-colors duration-300">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;
        const { motion, AnimatePresence } = Motion;

        // --- Database ---
        const db = new Dexie('RamadanPlannerDB');
        db.version(1).stores({
            appState: 'key'
        });

        // --- Components ---

        // Moon Phase Component
        const MoonPhase = ({ day }) => {
            const isLastTen = day >= 21;

            const getMoonPath = (d) => {
                const r = 45;
                const c = 50;
                let rx, sweep;
                if (d <= 15) {
                    rx = Math.abs(r - (d / 7.5) * r);
                    sweep = d <= 7.5 ? 0 : 1;
                    return `M ${c} ${c-r} A ${r} ${r} 0 0 1 ${c} ${c+r} A ${rx} ${r} 0 0 ${sweep} ${c} ${c-r}`;
                } else {
                    const d2 = d - 15;
                    rx = Math.abs(r - (d2 / 7.5) * r);
                    sweep = d2 <= 7.5 ? 1 : 0;
                    return `M ${c} ${c-r} A ${r} ${r} 0 0 0 ${c} ${c+r} A ${rx} ${r} 0 0 ${sweep} ${c} ${c-r}`;
                }
            };

            return (
                <div className="relative flex items-center justify-center w-12 h-12">
                    {isLastTen && (
                        <motion.div
                            animate={{ scale: [1, 1.2, 1], opacity: [0.3, 0.6, 0.3] }}
                            transition={{ repeat: Infinity, duration: 3 }}
                            className="absolute inset-0 bg-gold/20 blur-xl rounded-full"
                        ></motion.div>
                    )}
                    <svg viewBox="0 0 100 100" className="w-10 h-10 drop-shadow-xl relative z-10">
                        <circle cx="50" cy="50" r="45" className="fill-slate-200/50 dark:fill-slate-800/50" />
                        <motion.path
                            initial={false}
                            animate={{ d: getMoonPath(day) }}
                            transition={{ duration: 1, ease: "easeInOut" }}
                            className="fill-gold"
                        />
                    </svg>
                </div>
            );
        };

        // Iftar/Suhoor Widget
        const PrayerCountdown = ({ isSuhoor, timeLeft, onToggle }) => {
            return (
                <motion.div
                    onClick={onToggle}
                    initial={{ opacity: 0, y: 10 }}
                    animate={{ opacity: 1, y: 0 }}
                    className={`relative overflow-hidden p-4 rounded-2xl flex justify-between items-center shadow-lg transition-colors duration-1000 cursor-pointer active:scale-95 ${isSuhoor ? 'bg-indigo-900' : 'bg-orange-600'}`}
                >
                    <div className="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16 blur-2xl"></div>
                    <div className="relative z-10">
                        <span className="text-[10px] uppercase font-bold text-white/70 block mb-1 tracking-widest">
                            {isSuhoor ? 'متبقي للسحور' : 'متبقي للإفطار'}
                        </span>
                        <span className="text-3xl font-bold text-white tabular-nums tracking-tight">
                            {timeLeft}
                        </span>
                    </div>
                    <div className="relative z-10 bg-white/20 backdrop-blur-md p-3 rounded-xl border border-white/20">
                        <i data-lucide={isSuhoor ? "moon" : "sun"} className="w-6 h-6 text-white"></i>
                    </div>
                </motion.div>
            );
        };

        // 6. Impact Map Component
        const ImpactMap = ({ allDaysProgress }) => {
            return (
                <div className="mt-8 mb-8">
                    <h3 className="text-[10px] font-bold text-gray-400 mb-4 text-center uppercase tracking-[0.3em]">خارطة الأثر</h3>
                    <div className="grid grid-cols-10 gap-2 max-w-[280px] mx-auto bg-white/50 dark:bg-slate-900/50 p-4 rounded-3xl backdrop-blur-sm border border-gray-100 dark:border-slate-800">
                        {Array.from({ length: 30 }).map((_, i) => {
                            const day = i + 1;
                            const progress = allDaysProgress[day] || 0;

                            let intensity = "bg-gray-100 dark:bg-slate-800";
                            if (progress > 85) intensity = "bg-gold shadow-[0_0_10px_rgba(251,191,36,0.5)] scale-110";
                            else if (progress > 50) intensity = "bg-gold/60";
                            else if (progress > 20) intensity = "bg-gold/30";
                            else if (progress > 0) intensity = "bg-gold/10";

                            return (
                                <motion.div
                                    key={day}
                                    initial={{ scale: 0 }}
                                    animate={{ scale: 1 }}
                                    transition={{ delay: i * 0.02 }}
                                    className={`w-full aspect-square rounded-[4px] ${intensity} transition-all duration-500`}
                                    title={`اليوم ${day}: ${Math.round(progress)}%`}
                                ></motion.div>
                            );
                        })}
                    </div>
                </div>
            );
        };

        // Spiritual Sprout Component
        const SpiritualSprout = ({ progress }) => {
            let icon = "circle-dot";
            if (progress > 75) icon = "flower";
            else if (progress > 50) icon = "leaf";
            else if (progress > 25) icon = "sprout";

            return (
                <div key={icon} className="transition-all duration-500 transform hover:scale-110">
                    <i data-lucide={icon} className="w-5 h-5 text-green-600 dark:text-green-400"></i>
                </div>
            );
        };

        // 1. Progress Widget (Circular)
        const ProgressWidget = ({ progress, theme }) => {
            const radius = 45;
            const stroke = 6;
            const normalizedRadius = radius - stroke * 2;
            const circumference = normalizedRadius * 2 * Math.PI;
            const strokeDashoffset = circumference - (progress / 100) * circumference;

            return (
                <div className="flex items-center justify-between p-3 glass-card rounded-2xl mb-4 relative overflow-hidden">
                    <div className={`absolute top-0 right-0 w-1 h-full ${theme.accent} opacity-20`}></div>
                    <div className="relative w-20 h-20 flex items-center justify-center">
                        <svg height={radius * 2} width={radius * 2} className="rotate-[-90deg]">
                            <circle
                                stroke="currentColor"
                                strokeWidth={stroke}
                                r={normalizedRadius}
                                cx={radius}
                                cy={radius}
                                fill="transparent"
                                className="text-gray-200 dark:text-slate-800"
                            />
                            <motion.circle
                                stroke="#fbbf24"
                                strokeWidth={stroke}
                                strokeDasharray={circumference + ' ' + circumference}
                                initial={{ strokeDashoffset: circumference }}
                                animate={{ strokeDashoffset }}
                                transition={{ duration: 1, ease: "easeOut" }}
                                strokeLinecap="round"
                                r={normalizedRadius}
                                cx={radius}
                                cy={radius}
                                fill="transparent"
                            />
                        </svg>
                        <div className="absolute text-center">
                            <span className={`text-lg font-bold block ${theme.text}`}>{Math.round(progress)}%</span>
                        </div>
                    </div>

                    <div className="flex-1 mr-4 text-right">
                        <h3 className="text-sm font-bold text-navy dark:text-white mb-1">إنجاز اليوم</h3>
                        <div className="flex items-center gap-2">
                            <SpiritualSprout progress={progress} />
                            <span className="text-xs text-gray-500 dark:text-gray-400">نمو الروح</span>
                        </div>
                    </div>
                </div>
            );
        };

        // Islamic Quiz Component
        const IslamicQuizCard = ({ question, options, correctAnswer, theme, isDarkMode }) => {
            const [selectedOption, setSelectedOption] = useState(null);
            const [isCorrect, setIsCorrect] = useState(null);

            const handleSelect = (index) => {
                if (selectedOption !== null) return;
                setSelectedOption(index);
                setIsCorrect(index === correctAnswer);
                if (navigator.vibrate) navigator.vibrate(index === correctAnswer ? [10, 30] : 50);
            };

            return (
                <div className="glass-card p-5 rounded-3xl mb-4 relative overflow-hidden">
                    <div className="flex justify-between items-center mb-4">
                        <span className="text-[10px] font-bold text-gray-400 uppercase tracking-widest">اختبر معلوماتك</span>
                        {isCorrect !== null && (
                            <motion.span
                                initial={{ scale: 0 }}
                                animate={{ scale: 1 }}
                                className={`text-[10px] font-bold px-3 py-1 rounded-full ${isCorrect ? 'bg-green-100 text-green-600' : 'bg-red-100 text-red-600'}`}
                            >
                                {isCorrect ? 'إجابة صحيحة ✓' : 'حاول مرة أخرى ✗'}
                            </motion.span>
                        )}
                    </div>
                    <h3 className={`text-sm font-bold mb-4 leading-relaxed ${isDarkMode ? 'text-white' : 'text-navy'}`}>{question}</h3>
                    <div className="space-y-2">
                        {options.map((option, i) => {
                            let style = "bg-gray-50 dark:bg-slate-800/50 text-gray-600 dark:text-gray-300 border-gray-100 dark:border-slate-800";
                            if (selectedOption === i) {
                                style = i === correctAnswer
                                    ? "bg-green-500 text-white border-green-500 shadow-lg"
                                    : "bg-red-500 text-white border-red-500 shadow-lg";
                            } else if (selectedOption !== null && i === correctAnswer) {
                                style = "bg-green-100 dark:bg-green-900/30 text-green-600 border-green-200";
                            }

                            return (
                                <motion.button
                                    key={i}
                                    whileTap={{ scale: 0.98 }}
                                    onClick={() => handleSelect(i)}
                                    className={`w-full text-right p-4 rounded-2xl text-xs font-bold border transition-all ${style}`}
                                >
                                    {option}
                                </motion.button>
                            );
                        })}
                    </div>
                    {selectedOption !== null && (
                        <motion.button
                            initial={{ opacity: 0 }}
                            animate={{ opacity: 1 }}
                            onClick={() => { setSelectedOption(null); setIsCorrect(null); }}
                            className="mt-4 w-full text-center text-[10px] font-bold text-gray-400"
                        >
                            سؤال آخر؟
                        </motion.button>
                    )}
                </div>
            );
        };

        // Daily Dua Component
        const DailyDuaCard = ({ dua, translation, theme, isDarkMode }) => {
            const [copied, setCopied] = useState(false);

            const handleCopy = () => {
                navigator.clipboard.writeText(dua);
                if (navigator.vibrate) navigator.vibrate(50);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            return (
                <div className="glass-card p-6 rounded-[2rem] mb-4 text-center relative overflow-hidden border-none shadow-xl">
                    <div className={`absolute top-0 right-0 w-24 h-24 ${theme.bg} rounded-bl-full -mr-12 -mt-12 opacity-50`}></div>
                    <span className="text-[10px] font-bold text-gray-400 uppercase tracking-widest block mb-4">دعاء اليوم</span>
                    <p className={`text-xl font-bold leading-relaxed mb-4 font-sans ${isDarkMode ? 'text-white' : 'text-navy'}`}>
                        {dua}
                    </p>
                    <p className="text-sm text-gray-400 mb-6 font-medium">{translation}</p>
                    <div className="flex justify-center gap-4">
                        <button
                            onClick={handleCopy}
                            className={`flex items-center gap-2 px-6 py-2.5 rounded-2xl text-xs font-bold transition-all ${copied ? 'bg-green-500 text-white' : 'bg-gray-100 dark:bg-slate-800 text-gray-600 dark:text-gray-300'}`}
                        >
                            <i data-lucide={copied ? "check" : "copy"} className="w-4 h-4"></i>
                            {copied ? 'تم النسخ' : 'نسخ'}
                        </button>
                        <button className="flex items-center gap-2 px-6 py-2.5 rounded-2xl text-xs font-bold bg-gray-100 dark:bg-slate-800 text-gray-600 dark:text-gray-300">
                            <i data-lucide="share-2" className="w-4 h-4"></i>
                            مشاركة
                        </button>
                    </div>
                </div>
            );
        };

        // Daily Challenge Component
        const DailyChallenge = ({ challenge, isCompleted, onToggle, theme, isDarkMode }) => {
            return (
                <motion.div
                    onClick={onToggle}
                    animate={isCompleted ? { backgroundColor: '#fbbf24', scale: [1, 1.02, 1] } : { backgroundColor: isDarkMode ? '#1e293b' : '#1e3a8a' }}
                    className={`rounded-2xl p-4 flex items-center gap-4 cursor-pointer transition-colors shadow-lg mb-4 relative overflow-hidden`}
                >
                    {isCompleted && (
                        <motion.div
                            initial={{ x: "-100%" }}
                            animate={{ x: "200%" }}
                            transition={{ duration: 1.5, repeat: Infinity, repeatDelay: 3 }}
                            className="absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent skew-x-12"
                        ></motion.div>
                    )}
                    <div className={`p-2 rounded-xl transition-colors ${isCompleted ? 'bg-white text-gold' : 'bg-gold text-navy'}`}>
                        <i data-lucide={isCompleted ? "check-circle" : "zap"} className="w-5 h-5"></i>
                    </div>
                    <div className="flex-1">
                        <span className={`text-[10px] uppercase font-bold block mb-0.5 ${isCompleted ? 'text-navy/60' : 'text-white/50'}`}>تحدي اليوم</span>
                        <p className={`text-sm font-bold ${isCompleted ? 'text-navy' : 'text-white'}`}>{challenge}</p>
                    </div>
                    {isCompleted && (
                        <motion.div
                            initial={{ scale: 0, rotate: -45 }}
                            animate={{ scale: 1, rotate: 0 }}
                            className="bg-white/20 backdrop-blur-sm p-1.5 rounded-lg border border-white/20"
                        >
                            <i data-lucide="award" className="w-5 h-5 text-white"></i>
                        </motion.div>
                    )}
                </motion.div>
            );
        };

        // 7. Hydration Tracker
        const HydrationTracker = ({ cupsDrank, onToggleCup, theme, isDarkMode }) => {
            return (
                <div className="glass-card p-4 rounded-2xl mb-4">
                    <div className="flex justify-between items-center mb-4">
                        <div className="flex items-center gap-2">
                            <div className="bg-blue-100 dark:bg-blue-900/30 p-2 rounded-lg">
                                <i data-lucide="droplets" className="w-4 h-4 text-blue-500"></i>
                            </div>
                            <h3 className="font-bold text-navy dark:text-white text-sm font-sans">ترطيب الجسم</h3>
                        </div>
                        <span className="text-[10px] font-bold text-blue-600 bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded-full">
                            {cupsDrank} / 8 أكواب
                        </span>
                    </div>
                    <div className="flex justify-between gap-1.5">
                        {Array.from({ length: 8 }).map((_, i) => (
                            <motion.button
                                key={i}
                                onClick={() => onToggleCup(i)}
                                whileTap={{ scale: 0.9 }}
                                className={`relative flex-1 aspect-[2/3.5] rounded-xl border-2 transition-all overflow-hidden ${
                                    i < cupsDrank
                                    ? 'border-blue-400 shadow-inner'
                                    : 'border-gray-100 dark:border-slate-800 bg-gray-50/50 dark:bg-slate-900/30'
                                }`}
                            >
                                <AnimatePresence>
                                    {i < cupsDrank && (
                                        <motion.div
                                            initial={{ y: "100%" }}
                                            animate={{ y: 0 }}
                                            exit={{ y: "100%" }}
                                            className="absolute inset-0 bg-gradient-to-t from-blue-500 to-blue-400"
                                        >
                                            <motion.div
                                                animate={{ y: [-10, -50], x: [0, 5, -5, 0], opacity: [0, 1, 0] }}
                                                transition={{ repeat: Infinity, duration: 2, delay: 0.2 }}
                                                className="absolute bottom-2 left-2 w-1.5 h-1.5 bg-white/40 rounded-full"
                                            ></motion.div>
                                            <motion.div
                                                animate={{ y: [-5, -40], x: [0, -3, 3, 0], opacity: [0, 1, 0] }}
                                                transition={{ repeat: Infinity, duration: 1.5, delay: 0.5 }}
                                                className="absolute bottom-4 right-2 w-1 h-1 bg-white/30 rounded-full"
                                            ></motion.div>
                                        </motion.div>
                                    )}
                                </AnimatePresence>
                            </motion.button>
                        ))}
                    </div>
                </div>
            );
        };

        // 2. Habit Tracker Grid
        const HabitTracker = ({ items, onItemToggle, onLongPress, theme, isDarkMode, isShaking }) => {
            return (
                <div className="glass-card p-4 rounded-2xl mb-4">
                    <div className="flex justify-between items-center mb-4">
                        <div className="flex items-center gap-2">
                             <div className={`${theme.bg} p-2 rounded-lg`}>
                                <i data-lucide="layout-grid" className={`w-4 h-4 ${theme.text}`}></i>
                            </div>
                            <h3 className="font-bold text-navy dark:text-white text-sm">تتبع العادات</h3>
                        </div>
                        <span className="text-[10px] text-gray-400 font-medium">اضغط مطولاً للتعديل</span>
                    </div>
                    <div className="grid grid-cols-4 gap-3">
                        {items.map((item) => (
                            <motion.button
                                key={item.id}
                                layout
                                animate={isShaking ? {
                                    rotate: [0, -1, 1, -1, 1, 0],
                                    transition: { repeat: Infinity, duration: 0.3 }
                                } : { rotate: 0 }}
                                onPointerDown={(e) => {
                                    const timer = setTimeout(() => onLongPress(), 600);
                                    e.target.dataset.timer = timer;
                                }}
                                onPointerUp={(e) => {
                                    clearTimeout(parseInt(e.target.dataset.timer));
                                }}
                                onClick={() => isShaking ? null : onItemToggle(item.id)}
                                className={`flex flex-col items-center justify-center p-3 rounded-2xl transition-all relative aspect-square ${
                                    item.completed 
                                    ? `${theme.accent} text-white shadow-lg shadow-${theme.id}-500/20`
                                    : 'bg-gray-50 dark:bg-slate-800/50 text-gray-400 border border-gray-100 dark:border-slate-800'
                                }`}
                            >
                                {item.isCustom && (
                                    <div className="absolute -top-1 -right-1 w-2.5 h-2.5 bg-gold rounded-full border-2 border-white dark:border-slate-900 shadow-sm"></div>
                                )}
                                {isShaking && (
                                    <div className="absolute -top-2 -left-2 bg-red-500 text-white rounded-full p-0.5 shadow-sm">
                                        <i data-lucide="minus" className="w-3 h-3"></i>
                                    </div>
                                )}
                                <div className="mb-2">
                                    <i data-lucide={item.iconName} className="w-5 h-5"></i>
                                </div>
                                <span className="text-[10px] font-bold text-center leading-tight">{item.label}</span>
                            </motion.button>
                        ))}
                        <button className="flex flex-col items-center justify-center p-3 rounded-2xl border-2 border-dashed border-gray-200 dark:border-slate-800 text-gray-400 aspect-square active:scale-95 transition-all">
                            <i data-lucide="plus" className="w-5 h-5 mb-1"></i>
                            <span className="text-[10px] font-bold">إضافة</span>
                        </button>
                    </div>
                </div>
            );
        };

        // 3. Floating Action Button (Tasbih)
        const TasbihFAB = ({ count, onIncrement }) => {
            return (
                <motion.button
                    whileTap={{ scale: 0.85 }}
                    onClick={onIncrement}
                    className="fixed bottom-8 left-8 w-18 h-18 bg-navy dark:bg-slate-800 rounded-full shadow-[0_15px_30px_rgba(0,0,0,0.3)] flex items-center justify-center z-50 transition-transform border-4 border-gold/30"
                >
                    <div className="absolute inset-0 bg-gold/10 rounded-full animate-ping"></div>
                    <div className="text-center text-white relative z-10">
                        <span className="block text-[10px] font-bold opacity-60 uppercase tracking-tighter">سبّح</span>
                        <span className="block text-xl font-black text-gold tabular-nums">{count}</span>
                    </div>
                </motion.button>
            );
        };

        // 4. Modal Component
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-end justify-center bg-black/60 backdrop-blur-sm p-4 animate-in fade-in duration-200">
                    <div className="bg-white dark:bg-slate-900 w-full rounded-2xl p-5 shadow-2xl animate-in slide-in-from-bottom duration-300">
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-lg font-bold text-navy dark:text-white">{title}</h3>
                            <button onClick={onClose} className="p-1 bg-gray-100 rounded-full"><i data-lucide="x" className="w-5 h-5 text-gray-600"></i></button>
                        </div>
                        {children}
                    </div>
                </div>
            );
        };

        // Khatma Logging Bottom Sheet
        const KhatmaLoggingSheet = ({ isOpen, onClose, onSave, theme, isDarkMode }) => {
            const [mode, setMode] = useState('page');
            const [value, setValue] = useState('');

            useEffect(() => {
                if (isOpen) setValue('');
            }, [isOpen]);

            const handleSave = () => {
                let pageNum = parseInt(value);
                if (isNaN(pageNum)) return;

                if (mode === 'juz') pageNum = (pageNum - 1) * 20 + 1; // Approx
                // Surah mapping would be more complex, keeping it simple for prototype

                onSave(pageNum);
                onClose();
            };

            return (
                <AnimatePresence>
                    {isOpen && (
                        <div className="fixed inset-0 z-[100] flex items-end justify-center">
                            <motion.div
                                initial={{ opacity: 0 }}
                                animate={{ opacity: 1 }}
                                exit={{ opacity: 0 }}
                                onClick={onClose}
                                className="absolute inset-0 bg-black/60 backdrop-blur-sm"
                            />
                            <motion.div
                                initial={{ y: "100%" }}
                                animate={{ y: 0 }}
                                exit={{ y: "100%" }}
                                transition={{ type: "spring", damping: 30, stiffness: 300 }}
                                className={`relative w-full max-w-md ${isDarkMode ? 'bg-slate-900' : 'bg-white'} rounded-t-[32px] p-8 shadow-2xl`}
                            >
                                <div className="w-12 h-1.5 bg-gray-200 dark:bg-slate-800 rounded-full mx-auto mb-8"></div>
                                <h3 className={`text-xl font-bold mb-6 text-center ${isDarkMode ? 'text-white' : 'text-navy'}`}>تسجيل التقدم في الورد</h3>

                                <div className="flex bg-gray-100 dark:bg-slate-800 p-1.5 rounded-2xl mb-8">
                                    {[
                                        {id: 'page', label: 'صفحة'},
                                        {id: 'juz', label: 'جزء'},
                                        {id: 'surah', label: 'سورة'}
                                    ].map(m => (
                                        <button
                                            key={m.id}
                                            onClick={() => setMode(m.id)}
                                            className={`flex-1 py-3 text-sm font-bold rounded-xl transition-all ${mode === m.id ? 'bg-white dark:bg-slate-700 shadow-sm text-navy dark:text-gold' : 'text-gray-400'}`}
                                        >
                                            {m.label}
                                        </button>
                                    ))}
                                </div>

                                <div className="relative mb-8">
                                    <input
                                        type="number"
                                        placeholder={mode === 'page' ? 'رقم الصفحة' : mode === 'juz' ? 'رقم الجزء' : 'رقم السورة'}
                                        className={`w-full p-5 ${isDarkMode ? 'bg-slate-800 text-white border-slate-700' : 'bg-gray-50 text-navy border-gray-200'} border-2 rounded-2xl text-center text-2xl font-bold focus:border-gold outline-none transition-all`}
                                        value={value}
                                        onChange={(e) => setValue(e.target.value)}
                                        autoFocus
                                    />
                                    <div className="absolute left-4 top-1/2 -translate-y-1/2 text-gold opacity-50">
                                        <i data-lucide="hash" className="w-6 h-6"></i>
                                    </div>
                                </div>

                                <button
                                    onClick={handleSave}
                                    className={`w-full ${theme.accent} text-white font-bold py-5 rounded-2xl shadow-xl shadow-blue-500/20 active:scale-[0.98] transition-all text-lg`}
                                >
                                    تأكيد الحفظ
                                </button>

                                <div className="mt-6 text-center">
                                    <button onClick={onClose} className="text-gray-400 text-sm font-medium">إلغاء</button>
                                </div>
                            </motion.div>
                        </div>
                    )}
                </AnimatePresence>
            );
        };

        // Smart Khatma Dashboard
        const KhatmaDashboard = ({ currentPage, totalPages, theme, ramadanDay, onOpenLogging }) => {
            const progress = (currentPage / totalPages) * 100;
            const pagesPerDay = Math.ceil(604 / 28);
            const targetStart = (ramadanDay - 1) * pagesPerDay + 1;
            const targetEnd = Math.min(ramadanDay * pagesPerDay, 604);

            return (
                <div className="glass-card p-4 rounded-2xl mb-4 relative overflow-hidden">
                    <div className="flex justify-between items-center mb-4">
                        <div className="flex items-center gap-2">
                            <div className={`${theme.bg} p-2 rounded-lg`}>
                                <i data-lucide="book-open" className={`w-4 h-4 ${theme.text}`}></i>
                            </div>
                            <h3 className="font-bold text-navy dark:text-white text-sm font-sans">ختمة القرآن</h3>
                        </div>
                        <span className="text-[10px] font-bold text-gray-400 bg-gray-100 dark:bg-slate-800 px-2 py-1 rounded-full">
                            ص {currentPage} من {totalPages}
                        </span>
                    </div>

                    <div className="mb-4">
                        <div className="flex justify-between text-[10px] mb-1.5">
                            <span className="text-gray-500">التقدم الإجمالي</span>
                            <span className="font-bold text-gold">{Math.round(progress)}%</span>
                        </div>
                        <div className="h-1 bg-gray-100 dark:bg-slate-800 rounded-full overflow-hidden relative">
                            <motion.div
                                initial={{ width: 0 }}
                                animate={{ width: `${progress}%` }}
                                transition={{ duration: 1, ease: "easeOut" }}
                                className="h-full bg-gold shadow-[0_0_10px_rgba(251,191,36,0.6)]"
                            ></motion.div>
                        </div>
                    </div>

                    <div className={`${theme.bg} p-3 rounded-xl flex justify-between items-center border border-white/10`}>
                        <div className="text-right">
                            <span className="text-[10px] text-gray-500 block mb-0.5">ورد اليوم المقترح</span>
                            <span className={`text-xs font-bold ${theme.text}`}>من ص {targetStart} إلى ص {targetEnd}</span>
                        </div>
                        <button
                            onClick={onOpenLogging}
                            className={`${theme.accent} text-white px-4 py-2 rounded-xl text-[10px] font-bold shadow-lg shadow-emerald-500/20 active:scale-95 transition-all`}
                        >
                            تتبع الورد
                        </button>
                    </div>
                </div>
            );
        };

        // 5. Dhikr Capsule Component
        const DhikrCapsule = ({ isDarkMode }) => {
            const dhikrs = [
                "سبحان الله وبحمده", "سبحان الله العظيم", "لا إله إلا الله", "أستغفر الله وأتوب إليه",
                "اللهم صلِّ وسلم على نبينا محمد", "لا حول ولا قوة إلا بالله", "الحمد لله حمداً كثيراً",
                "الله أكبر كبيراً", "لا إله إلا الله وحده لا شريك له", "حسبي الله ونعم الوكيل",
                "سبحان الملك القدوس", "يا حي يا قيوم برحمتك أستغيث"
            ];
            const [currentDhikr, setCurrentDhikr] = useState("");
            const [copied, setCopied] = useState(false);

            useEffect(() => {
                const hour = new Date().getHours();
                setCurrentDhikr(dhikrs[hour % dhikrs.length]);
            }, []);

            useEffect(() => {
                if (window.lucide) window.lucide.createIcons();
            }, [currentDhikr, copied]);

            const handleAction = () => {
                navigator.clipboard.writeText(currentDhikr);
                if (navigator.vibrate) navigator.vibrate(40);
                setCopied(true);
                setTimeout(() => setCopied(false), 2000);
            };

            return (
                <motion.div
                    whileTap={{ scale: 0.98 }}
                    onClick={handleAction}
                    className={`p-4 rounded-2xl flex items-center justify-between cursor-pointer transition-all mb-4 border-2 shadow-lg group ${isDarkMode ? 'bg-slate-900 border-gold/10' : 'bg-navy border-gold/20'}`}
                >
                    <div className="flex items-center gap-4">
                        <div className="bg-gold/10 p-2.5 rounded-xl group-hover:bg-gold/20 transition-colors">
                            <i data-lucide="sparkles" className="w-5 h-5 text-gold"></i>
                        </div>
                        <div className="flex flex-col text-right">
                            <span className="text-[10px] text-gold/60 font-black uppercase tracking-widest mb-0.5">ذكر الساعة</span>
                            <span className="text-sm font-bold text-white">{currentDhikr}</span>
                        </div>
                    </div>
                    <div className="flex items-center">
                        <AnimatePresence mode="wait">
                            {copied ? (
                                <motion.div key="check" initial={{ scale: 0 }} animate={{ scale: 1 }} exit={{ scale: 0 }}>
                                    <i data-lucide="check" className="w-5 h-5 text-green-400"></i>
                                </motion.div>
                            ) : (
                                <motion.div key="copy" initial={{ opacity: 0 }} animate={{ opacity: 0.4 }} className="group-hover:opacity-100">
                                    <i data-lucide="copy" className="w-5 h-5 text-white"></i>
                                </motion.div>
                            )}
                        </AnimatePresence>
                    </div>
                </motion.div>
            );
        };

        // Theme Switcher Component
        const ThemeSwitcher = ({ currentTheme, currentMode, onThemeChange, onModeToggle }) => {
            const themes = [
                { id: 'emerald', color: 'bg-emerald-500', label: 'زمردي' },
                { id: 'royal', color: 'bg-blue-600', label: 'ملكي' },
                { id: 'serenity', color: 'bg-sky-400', label: 'هادئ' }
            ];

            return (
                <div className="flex flex-col gap-4 p-4 glass-card rounded-2xl">
                    <div className="flex justify-between items-center">
                        <span className="text-sm font-bold text-navy dark:text-white">المظهر</span>
                        <div className="flex gap-2">
                            {themes.map(t => (
                                <button
                                    key={t.id}
                                    onClick={() => onThemeChange(t.id)}
                                    className={`w-8 h-8 rounded-full ${t.color} border-2 ${currentTheme === t.id ? 'border-gold scale-110' : 'border-transparent opacity-60'} transition-all`}
                                    title={t.label}
                                />
                            ))}
                        </div>
                    </div>
                    <div className="flex justify-between items-center border-t border-gray-100 dark:border-slate-800 pt-3">
                        <span className="text-sm font-bold text-navy dark:text-white">الوضع الداكن (OLED)</span>
                        <button
                            onClick={onModeToggle}
                            className={`w-12 h-6 rounded-full transition-colors relative ${currentMode ? 'bg-gold' : 'bg-gray-300'}`}
                        >
                            <div className={`absolute top-1 w-4 h-4 rounded-full bg-white transition-all ${currentMode ? 'left-7' : 'left-1'}`}></div>
                        </button>
                    </div>
                </div>
            );
        };

        // --- Main App ---
        function App() {
            const [mounted, setMounted] = useState(false);
            const [ramadanDay, setRamadanDay] = useState(1); // Default to 1st Ramadan
            const [allDaysProgress, setAllDaysProgress] = useState({});
            const [theme, setTheme] = useState('emerald');
            const [isDarkMode, setIsDarkMode] = useState(false);
            const [showThemeModal, setShowThemeModal] = useState(false);
            const [tasbihCount, setTasbihCount] = useState(0);
            const [dedication, setDedication] = useState('');
            const [showDedicationModal, setShowDedicationModal] = useState(false);
            const [timeLeft, setTimeLeft] = useState("05:20:10");
            const [isSuhoor, setIsSuhoor] = useState(false);
            const [khatmaPage, setKhatmaPage] = useState(45);
            const [showKhatmaModal, setShowKhatmaModal] = useState(false);
            const [isShaking, setIsShaking] = useState(false);
            const [cupsDrank, setCupsDrank] = useState(3);
            const [challengeCompleted, setChallengeCompleted] = useState(false);
            const [trackerItems, setTrackerItems] = useState([
                { id: 'fajr', label: 'الفجر', completed: false, iconName: 'sunrise' },
                { id: 'dhuhr', label: 'الظهر', completed: false, iconName: 'sun' },
                { id: 'asr', label: 'العصر', completed: false, iconName: 'cloud-sun' },
                { id: 'maghrib', label: 'المغرب', completed: false, iconName: 'sunset' },
                { id: 'isha', label: 'العشاء', completed: false, iconName: 'moon' },
                { id: 'taraweeh', label: 'تراويح', completed: false, iconName: 'star' },
                { id: 'quran', label: 'ورد', completed: false, iconName: 'book-open' },
                { id: 'dhikr', label: 'ذكر', completed: false, iconName: 'sparkles', isCustom: true },
            ]);

            // Load from Dexie
            useEffect(() => {
                const initDB = async () => {
                    try {
                        const savedDay = await db.appState.get('ramadanDay');
                        const day = savedDay ? savedDay.value : 1;
                        if (savedDay) setRamadanDay(day);

                        const savedTheme = await db.appState.get('theme');
                        if (savedTheme) setTheme(savedTheme.value);

                        const savedDarkMode = await db.appState.get('isDarkMode');
                        if (savedDarkMode) setIsDarkMode(savedDarkMode.value);

                        const savedKhatma = await db.appState.get('khatmaPage');
                        if (savedKhatma) setKhatmaPage(savedKhatma.value);

                        const savedWater = await db.appState.get('cupsDrank');
                        if (savedWater) setCupsDrank(savedWater.value);

                        const savedChallenge = await db.appState.get('challengeCompleted');
                        if (savedChallenge) setChallengeCompleted(savedChallenge.value);

                        const savedTasbih = await db.appState.get('tasbihCount');
                        const savedDedication = await db.appState.get('dedication');

                        // Load current day tracker
                        const savedTracker = await db.appState.get(`tracker_day_${day}`);

                        if (savedTasbih) setTasbihCount(savedTasbih.value);
                        if (savedDedication) {
                            setDedication(savedDedication.value);
                            setShowDedicationModal(false);
                        } else {
                            setShowDedicationModal(true);
                        }

                        if (savedTracker) {
                            setTrackerItems(prev => prev.map(item => ({
                                ...item,
                                completed: savedTracker.value.find(s => s.id === item.id)?.completed || false
                            })));
                        }

                        // Load all days progress for the map
                        const allProgress = {};
                        const itemCount = trackerItems.length;
                        for (let i = 1; i <= 30; i++) {
                            const data = await db.appState.get(`tracker_day_${i}`);
                            if (data) {
                                const completed = data.value.filter(v => v.completed).length;
                                allProgress[i] = (completed / itemCount) * 100;
                            }
                        }
                        setAllDaysProgress(allProgress);
                    } catch (err) {
                        console.error("Dexie Load Error:", err);
                    } finally {
                        setMounted(true);
                    }
                };
                initDB();
            }, []);

            // Simple timer for prototype
            useEffect(() => {
                const interval = setInterval(() => {
                    setTimeLeft(prev => {
                        const parts = prev.split(':').map(Number);
                        let s = parts[2], m = parts[1], h = parts[0];
                        if (s > 0) s--;
                        else if (m > 0) { m--; s = 59; }
                        else if (h > 0) { h--; m = 59; s = 59; }
                        return [h, m, s].map(v => v.toString().padStart(2, '0')).join(':');
                    });
                }, 1000);
                return () => clearInterval(interval);
            }, []);

            // Effects for persistence
            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'tasbihCount', value: tasbihCount });
                }
            }, [tasbihCount, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'theme', value: theme });
                }
            }, [theme, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'khatmaPage', value: khatmaPage });
                }
            }, [khatmaPage, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'cupsDrank', value: cupsDrank });
                }
            }, [cupsDrank, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'challengeCompleted', value: challengeCompleted });
                }
            }, [challengeCompleted, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'isDarkMode', value: isDarkMode });
                    if (isDarkMode) {
                        document.documentElement.classList.add('dark', 'oled-mode');
                    } else {
                        document.documentElement.classList.remove('dark', 'oled-mode');
                    }
                }
            }, [isDarkMode, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({ key: 'ramadanDay', value: ramadanDay });

                    // Reload tracker items for the new day
                    const loadDayData = async () => {
                        const savedTracker = await db.appState.get(`tracker_day_${ramadanDay}`);
                        if (savedTracker) {
                            setTrackerItems(prev => prev.map(item => ({
                                ...item,
                                completed: savedTracker.value.find(s => s.id === item.id)?.completed || false
                            })));
                        } else {
                            setTrackerItems(prev => prev.map(item => ({ ...item, completed: false })));
                        }
                    };
                    loadDayData();
                }
            }, [ramadanDay, mounted]);

            useEffect(() => {
                if (mounted && dedication) {
                    db.appState.put({ key: 'dedication', value: dedication });
                }
            }, [dedication, mounted]);

            useEffect(() => {
                if (mounted) {
                    db.appState.put({
                        key: `tracker_day_${ramadanDay}`,
                        value: trackerItems.map(({id, completed}) => ({id, completed}))
                    });

                    // Update allDaysProgress for the map
                    const completedCount = trackerItems.filter(i => i.completed).length;
                    const pct = (completedCount / trackerItems.length) * 100;
                    setAllDaysProgress(prev => ({ ...prev, [ramadanDay]: pct }));

                    // Confetti Effect
                    if (pct === 100 && !allDaysProgress[ramadanDay] || (pct === 100 && allDaysProgress[ramadanDay] < 100)) {
                        confetti({
                            particleCount: 150,
                            spread: 70,
                            origin: { y: 0.7 },
                            colors: ['#fbbf24', '#1e3a8a', '#10b981']
                        });
                        if (navigator.vibrate) navigator.vibrate([100, 50, 100]);
                    }
                }
                if (window.lucide) window.lucide.createIcons();
            }, [trackerItems, mounted, ramadanDay]);

            // Handlers
            const handleTrack = (id) => {
                if (navigator.vibrate) navigator.vibrate(20); // Haptic
                setTrackerItems(prev => prev.map(item => 
                    item.id === id ? { ...item, completed: !item.completed } : item
                ));
            };

            const handleTasbih = () => {
                if (navigator.vibrate) navigator.vibrate(10); // Light Haptic
                setTasbihCount(p => p + 1);
            };

            const saveDedication = (name) => {
                setDedication(name);
                setShowDedicationModal(false);
            };

            // Calculated
            const progress = useMemo(() => {
                const completed = trackerItems.filter(i => i.completed).length;
                return (completed / trackerItems.length) * 100;
            }, [trackerItems]);

            if (!mounted) return null;

            const themeClasses = {
                emerald: {
                    text: 'text-emerald-600 dark:text-emerald-400',
                    bg: 'bg-emerald-50 dark:bg-emerald-950/30',
                    accent: 'bg-emerald-600',
                    border: 'border-emerald-200 dark:border-emerald-800'
                },
                royal: {
                    text: 'text-blue-600 dark:text-blue-400',
                    bg: 'bg-blue-50 dark:bg-blue-950/30',
                    accent: 'bg-blue-600',
                    border: 'border-blue-200 dark:border-blue-800'
                },
                serenity: {
                    text: 'text-sky-500 dark:text-sky-400',
                    bg: 'bg-sky-50 dark:bg-sky-950/30',
                    accent: 'bg-sky-500',
                    border: 'border-sky-200 dark:border-sky-800'
                }
            };

            const currentTheme = themeClasses[theme];

            return (
                <div className={`min-h-screen px-4 py-6 font-sans flex flex-col transition-colors duration-500 ${isDarkMode ? 'bg-black text-slate-200' : 'bg-offwhite text-slate-800'}`}>
                    
                    {/* Header */}
                    <div className="flex justify-between items-center mb-6">
                        <div className="flex items-center gap-3">
                            <div onClick={() => setRamadanDay(prev => prev % 30 + 1)} className="cursor-pointer">
                                <MoonPhase day={ramadanDay} />
                            </div>
                            <div className="flex flex-col">
                                <span className="text-xs text-gray-500 font-bold">{ramadanDay} رمضان | 1447</span>
                                <h1 className={`text-xl font-bold ${isDarkMode ? 'text-white' : 'text-navy'}`}>مفكرة رمضان</h1>
                            </div>
                        </div>
                        <div className="flex gap-2">
                             <button 
                                onClick={() => setShowThemeModal(true)}
                                className={`p-2 rounded-full ${isDarkMode ? 'bg-slate-800 text-gold' : 'bg-white text-navy shadow-sm'}`}
                             >
                                <i data-lucide="palette" className="w-5 h-5"></i>
                            </button>
                             <button 
                                onClick={() => alert('إعدادات الخصوصية: البيانات محفوظة محلياً بالكامل 🔒')}
                                className={`p-2 rounded-full ${isDarkMode ? 'bg-slate-800 text-gold' : 'bg-white text-navy shadow-sm'}`}
                             >
                                <i data-lucide="shield-check" className="w-5 h-5"></i>
                            </button>
                        </div>
                    </div>

                    {/* Countdown Widget */}
                    <div className="mb-4">
                        <PrayerCountdown
                            isSuhoor={isSuhoor}
                            timeLeft={timeLeft}
                            onToggle={() => setIsSuhoor(!isSuhoor)}
                        />
                    </div>

                    {/* Progress Widget */}
                    <ProgressWidget 
                        progress={progress} 
                        theme={currentTheme}
                    />

                    {/* Dhikr Capsule */}
                    <DhikrCapsule isDarkMode={isDarkMode} />

                    {/* Daily Challenge */}
                    <DailyChallenge
                        challenge="إفطار صائم ولو بشق تمرة أو شربة ماء"
                        isCompleted={challengeCompleted}
                        onToggle={() => {
                            if (navigator.vibrate) navigator.vibrate([30, 50, 30]);
                            setChallengeCompleted(!challengeCompleted);
                        }}
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                    />

                    {/* Islamic Quiz */}
                    <IslamicQuizCard
                        question="ما هي السورة التي تسمى عروس القرآن؟"
                        options={["سورة يس", "سورة الرحمن", "سورة الملك", "سورة الواقعة"]}
                        correctAnswer={1}
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                    />

                    {/* Daily Dua */}
                    <DailyDuaCard
                        dua="اللهم إنك عفو كريم تحب العفو فاعفُ عني"
                        translation="اللهم اجعلنا من عتقاء هذا الشهر الكريم"
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                    />

                    {/* Tracker */}
                    <HabitTracker
                        items={trackerItems}
                        onItemToggle={handleTrack}
                        onLongPress={() => setIsShaking(!isShaking)}
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                        isShaking={isShaking}
                    />

                    {/* Khatma Dashboard */}
                    <KhatmaDashboard
                        currentPage={khatmaPage}
                        totalPages={604}
                        theme={currentTheme}
                        ramadanDay={ramadanDay}
                        onOpenLogging={() => setShowKhatmaModal(true)}
                    />

                    {/* Hydration Tracker */}
                    <HydrationTracker
                        cupsDrank={cupsDrank}
                        onToggleCup={(i) => {
                            if (navigator.vibrate) navigator.vibrate(10);
                            setCupsDrank(i + 1 === cupsDrank ? i : i + 1);
                        }}
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                    />

                    {/* Impact Map */}
                    <ImpactMap allDaysProgress={allDaysProgress} />

                    {/* Dedication Area */}
                    <div className="mt-auto pt-6 text-center opacity-80">
                        <p className="text-xs text-gray-400">هذا العمل صدقة جارية عن</p>
                        <p className="text-sm font-bold text-navy mt-1 cursor-pointer" onClick={() => setShowDedicationModal(true)}>
                            {dedication || "اضغط لتحديد الاسم"} ❤️
                        </p>
                    </div>

                    {/* Footer Signature */}
                    <div className="mt-8 mb-20 text-center border-t border-gray-200 pt-4">
                        <p className="text-[10px] text-gray-400">تصميم وتطوير: صدام أحمد</p>
                        <div className="flex justify-center gap-4 mt-2 opacity-50">
                             <i data-lucide="twitter" className="w-3 h-3"></i>
                             <i data-lucide="github" className="w-3 h-3"></i>
                        </div>
                    </div>

                    {/* FAB */}
                    <TasbihFAB count={tasbihCount} onIncrement={handleTasbih} />

                    {/* Khatma Logging Sheet */}
                    <KhatmaLoggingSheet
                        isOpen={showKhatmaModal}
                        onClose={() => setShowKhatmaModal(false)}
                        onSave={(page) => setKhatmaPage(page)}
                        theme={currentTheme}
                        isDarkMode={isDarkMode}
                    />

                    {/* Theme Modal */}
                    <Modal
                        isOpen={showThemeModal}
                        onClose={() => setShowThemeModal(false)}
                        title="إعدادات المظهر"
                    >
                        <ThemeSwitcher
                            currentTheme={theme}
                            currentMode={isDarkMode}
                            onThemeChange={setTheme}
                            onModeToggle={() => setIsDarkMode(!isDarkMode)}
                        />
                    </Modal>

                    {/* Dedication Modal */}
                    <Modal 
                        isOpen={showDedicationModal} 
                        onClose={() => setShowDedicationModal(false)}
                        title="لمن تهدي ثواب هذا العمل؟"
                    >
                        <form onSubmit={(e) => { e.preventDefault(); saveDedication(e.target.name.value); }}>
                            <input 
                                name="name"
                                type="text" 
                                placeholder="اكتب الاسم هنا (مثلاً: والدي رحمه الله)" 
                                className={`w-full p-3 ${isDarkMode ? 'bg-slate-800 text-white border-slate-700' : 'bg-gray-50 text-right text-sm border-2 border-transparent'} focus:border-navy outline-none mb-4`}
                                autoFocus
                            />
                            <button type="submit" className="w-full bg-gold text-navy font-bold py-3 rounded-xl shadow-lg">
                                تأكيد الإهداء
                            </button>
                        </form>
                    </Modal>

                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
